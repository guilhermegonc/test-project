{% extends "base.html" %}
{% block title %}{{ user }}{% endblock %}
{% load static %}
{% block extra-css %}
    <link rel="stylesheet" type="text/css" href="{% static 'relay-control.css' %}">
{% endblock %}
{% block extra-js %}
    <script src="{% static 'relay-control.js' %}"></script>
{% endblock %}
{% block content%}
<div class="default-margin-bg">
    <div class="min-scroll">
        <h1 class="s3 p-12 light txt-center m-b-24">Bem-vindo, <br>{{ user }}</h1>
        {% for m in microcontrollers %}
            <div class="lateral-scroll m-b-24">
            {% for d in m %}
                <div id="p{{ d.id }}" class="trigger btn m-12 light shadow">
                    <div class="status"></div>
                    <p class="device-info">{% if d.name == '' %}Sem nome{% else %}{{ d.name }}{% endif %}</p>
                </div>
            {% endfor %}
                <a id="empty-{{ m.0.mtoken }}" class="trigger btn m-12 transparent-gray" href="/microcontroller/{{ m.0.mtoken }}?pin=D0"><div class="status">+</div></a>
                <a id="empty-{{ m.0.mtoken }}" class="trigger btn m-12 transparent-gray" href="/microcontroller/{{ m.0.mtoken }}?pin=D1"><div class="status">+</div></a>
                <a id="empty-{{ m.0.mtoken }}" class="trigger btn m-12 transparent-gray" href="/microcontroller/{{ m.0.mtoken }}?pin=D2"><div class="status">+</div></a>
                <a id="empty-{{ m.0.mtoken }}" class="trigger btn m-12 transparent-gray" href="/microcontroller/{{ m.0.mtoken }}?pin=D3"><div class="status">+</div></a>
                <a id="configs-unset" class="trigger round btn m-12 transparent-gray" href="/">
                    <div class="status">ðŸ”§</div>
                    <p class="device-info light">Ajustes</p>
                </a>
            </div>
        {% endfor %}
        <a class="btn shadow light m-b-12" href="/settings">ConfiguraÃ§Ãµes</a>
        <a class="btn shadow light" href="/logout">Sair</a>
    </div>
</div>
    <script>
        '{% for m in microcontrollers %}'
            '{% for d in m %}'
            let p{{ d.id }} = new BlynkObject('{{ d.mtoken }}', '{{ d.pin }}', 'p{{ d.id }}')
            '{% endfor %}'
        '{% endfor %}'
        '{% for t in m_tokens%}'
            document.querySelector('#configs-unset').href = "/microcontroller/{{ t }}"
            document.querySelector('#configs-unset').id = 'configs'
        '{% endfor %}'
    </script>
{% endblock %}